jQuery(function(b){var x=0<ajaxurl.indexOf("?")?"&":"?";b("#imagify-signup").click(function(a){a.preventDefault();swal({title:imagifyAdmin.labels.signupTitle,text:imagifyAdmin.labels.signupText,confirmButtonText:imagifyAdmin.labels.signupConfirmButtonText,type:"input",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,customClass:"imagify-sweet-alert imagify-sweet-alert-signup"},function(a){if(""==b.trim(a)||!a)return swal.showInputError(imagifyAdmin.labels.signupErrorEmptyEmail),!1;b.get(ajaxurl+
x+"action=imagify_signup&email="+a+"&imagifysignupnonce="+b("#imagifysignupnonce").val()).done(function(a){a.success?swal({title:imagifyAdmin.labels.signupSuccessTitle,text:imagifyAdmin.labels.signupSuccessText,type:"success",customClass:"imagify-sweet-alert"}):swal.showInputError(a.data)})})});b("#imagify-save-api-key").click(function(a){a.preventDefault();swal({title:imagifyAdmin.labels.saveApiKeyTitle,text:imagifyAdmin.labels.saveApiKeyText,confirmButtonText:imagifyAdmin.labels.saveApiKeyConfirmButtonText,
type:"input",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,customClass:"imagify-sweet-alert imagify-sweet-alert-signup"},function(a){if(""==b.trim(a)||!a)return swal.showInputError(imagifyAdmin.labels.signupErrorEmptyEmail),!1;b.get(ajaxurl+x+"action=imagify_check_api_key_validity&api_key="+a+"&imagifycheckapikeynonce="+b("#imagifycheckapikeynonce").val()).done(function(a){a.success?swal({title:imagifyAdmin.labels.ApiKeyCheckSuccessTitle,text:imagifyAdmin.labels.ApiKeyCheckSuccessText,
type:"success",customClass:"imagify-sweet-alert"}):swal.showInputError(a.data)})})});b(".imagify-notice-dismiss").click(function(a){a.preventDefault();var d=b(this);a=d.parents(".imagify-welcome, .imagify-notice");d=d.attr("href");a.fadeTo(100,0,function(){b(this).slideUp(100,function(){b(this).remove()})});b.get(d.replace("admin-post.php","admin-ajax.php"))});b(".imagify-modal").attr("aria-hidden","true");b(".imagify-modal-trigger").on("click.imagify",function(){var a=b(this),a=a.data("target")||
a.attr("href");b(a).css("display","flex").hide().fadeIn(400).attr("aria-hidden","false").attr("tabindex","0").focus().removeAttr("tabindex").addClass("modal-is-open");b("body").addClass("imagify-modal-is-open");return!1});b(document).on("click.imagify",".imagify-modal .close-btn",function(){b(this).closest(".imagify-modal").fadeOut(400).attr("aria-hidden","true").removeClass("modal-is-open");b("body").removeClass("imagify-modal-is-open")}).on("blur.imagify",".imagify-modal .close-btn",function(){var a=
b(this).closest(".imagify-modal");"false"===a.attr("aria-hidden")&&a.attr("tabindex","0").focus().removeAttr("tabindex")});b(document).on("click.imagify",".imagify-modal",function(a){b(a.target).filter(".modal-is-open").find(".close-btn").trigger("click.imagify")});b(window).on("keydown",function(a){if(27==a.keyCode&&0<b(".imagify-modal.modal-is-open").length)return a.preventDefault(),b(".imagify-modal.modal-is-open").find(".close-btn").trigger("click.imagify"),!1});var y=!1;b("#wp-admin-bar-imagify").hover(function(){if(!0!==
y){y=!0;var a=b("#wp-admin-bar-imagify-profile-content");a.is(":empty")&&b.get(ajaxurl+x+"action=imagify_get_admin_bar_profile&imagifygetadminbarprofilenonce="+b("#imagifygetadminbarprofilenonce").val()).done(function(d){a.html(d.data);b("#wp-admin-bar-imagify-profile-loading").remove();y=!1})}});if(b("#imagify-pricing-modal").length){var z=b("#imagify-pricing-modal"),n=function(a,b){b||(b=null);output="";if("object"===typeof a){var c=a.yearly+"",e=(a.monthly+"").split("."),c=c.split(".");output+=
'<span class="imagify-switch-my"><span aria-hidden="'+("monthly"===b?"false":"true")+'" class="imagify-monthly"><span class="imagify-price-big">'+e[0]+'</span> <span class="imagify-price-mini">.'+(1===e[1].length?e[1]+"0":e[1])+'</span></span> <span aria-hidden="'+("yearly"===b?"false":"true")+'" class="imagify-yearly"><span class="imagify-price-big">'+c[0]+'</span> <span class="imagify-price-mini">.'+(1===c[1].length?c[1]+"0":c[1])+"</span></span></span>"}else e=(a+"").split("."),output+='<span class="imagify-price-big">'+
e[0]+'</span> <span class="imagify-price-mini">.'+(1===e[1].length?e[1]+"0":e[1])+"</span>";return output},r=function(a,b,c,e){var g=b.additional_gb,f=b.annual_cost,l=b.id,p=b.label,m=b.monthly_cost,k=b.quota,h=b.cost;b=1E3<=k?k/1E3+" GB":k+" MB";f="monthly"===c?{monthly:m,yearly:Math.round(f/12*100)/100}:h;"undefined"!==typeof e&&a.addClass("imagify-"+c+"-"+p+e);a.find(".imagify-offer-size").text(b);a.find(".imagify-number-block").html(n(f,"monthly"));a.find(".imagify-approx-nb").text(5*k);"monthly"===
c&&a.find(".imagify-price-add-data").text("$"+g);(a.find(".imagify-payment-btn-select-plan").length?a.find(".imagify-payment-btn-select-plan"):a).attr("data-offer","monthly"===c?'{"'+p+'":{"id":'+l+',"name":"'+b+'","data":'+k+',"dataf":"'+b+'","imgs":'+5*k+',"prices":{"monthly":'+f.monthly+',"yearly":'+f.yearly+',"add":'+g+"}}}":'{"ot'+p+'":{"id":'+l+',"name":"'+b+'","data":'+k+',"dataf":"'+b+'","imgs":'+5*k+',"price":'+f+"}}");return a},D=function(a){a=a.data("nonce");var d={action:"imagify_get_prices",
imagifynonce:a},c={action:"imagify_get_images_counts",imagifynonce:a};z.find(".imagify-modal-loader").hide().show();b.post(ajaxurl,d,function(a){a.success&&b.post(ajaxurl,c,function(c){c=c.data;prices_datas=a.data;monthlies=prices_datas.monthlies;onetimes=prices_datas.onetimes;mo_user_cons=c.average_month_size.raw/1E6;ot_user_cons=c.total_library_size.raw/1E6;$mo_tpl=b("#imagify-offer-monthly-template");$ot_tpl=b("#imagify-offer-onetime-template");ot_clone=$ot_tpl.html();mo_clone=$mo_tpl.html();mo_html=
ot_html="";mo_suggested=ot_suggested=!1;if(null===monthlies||null===onetimes)c=b(".imagify-pre-checkout-offers"),c.hide().attr("aria-hidden",!0),c.closest(".imagify-modal-views").find(".imagify-popin-message").remove(),c.after('<div class="imagify-popin-message imagify-error"><p>'+imagifyAdmin.labels.errorPriceAPI+"</p></div>");else{b.each(monthlies,function(a,c){if("free"===c.label)return!0;var d=b(mo_clone).clone();if(!1!==mo_suggested&&2<a-mo_suggested)return!0;classes="";if(mo_user_cons<c.quota&&
!1===mo_suggested){classes=" imagify-offer-selected";mo_suggested=a;var e=b(".imagify-pre-checkout-offers").find(".imagify-offer-monthly");r(e,c,"monthly")}d=r(d,c,"monthly",classes);mo_html+=d[0].outerHTML});c=b(mo_html).filter(".imagify-offer-selected").prevAll();if(1<c.length){c=c.length-1;var d=b(mo_html);for(i=0;i<c;i++)delete d[i];mo_html="";for(j=0;j<d.length;j++)mo_html+=b("<div/>").append(d[j]).html()}b.each(onetimes,function(a,c){var d=b(ot_clone).clone();classes="";if(ot_user_cons<c.quota&&
!1===ot_suggested){classes=" imagify-offer-selected";ot_suggested=!0;var e=b(".imagify-pre-checkout-offers").find(".imagify-offer-onetime");r(e,c,"onetime")}d=r(d,c,"onetime",classes);ot_html+=d[0].outerHTML});$mo_tpl.parent().find(".imagify-offer-line")&&$mo_tpl.parent().find(".imagify-offer-line").remove();$mo_tpl.before(mo_html);$ot_tpl.parent().find(".imagify-offer-line")&&$ot_tpl.parent().find(".imagify-offer-line").remove();$ot_tpl.before(ot_html)}z.find(".imagify-modal-loader").fadeOut(300)})})},
B=function(a){a.each(function(){b(this).is(":checked")?b(this).closest(".imagify-offer-line").addClass("imagify-offer-selected"):b(this).closest(".imagify-offer-line").removeClass("imagify-offer-selected")})},C=function(a){a.each(function(){var a=b(this),c;c=a.parent(".imagify-cart-list-switcher").length?a.closest(".imagify-cart"):a.parent(".imagify-small-options").length?a.parent(".imagify-small-options").next(".imagify-pricing-table"):a.closest(".imagify-offer-line");var e=c.find(".imagify-switch-my");
"yearly"===a.val()?(c.addClass("imagify-year-selected").removeClass("imagify-month-selected"),e.find(".imagify-monthly").attr("aria-hidden","true"),e.find(".imagify-yearly").attr("aria-hidden","false")):(c.addClass("imagify-month-selected").removeClass("imagify-year-selected"),e.find(".imagify-monthly").attr("aria-hidden","false"),e.find(".imagify-yearly").attr("aria-hidden","true"))});return a},t=b(".imagify-offer-line").find(".imagify-checkbox"),u=b(".imagify-payment-modal").find(".imagify-radio-line").find("input");
B(t);C(u.filter(":checked"));t.on("change.imagify",function(){B(b(this))});u.on("change.imagify",function(){C(b(this))});b("#imagify-get-pricing-modal").on("click.imagify-ajax",function(){D(b(this))});var v=b("#imagify-plans-selection-view"),q=b("#imagify-payment-process-view"),w=b("#imagify-pre-checkout-view"),t=b("#imagify-success-view"),u=b(".imagify-choose-another-plan"),h=function(a){var d=b("#imagify-payment-iframe"),c=d.attr("src"),e=d.data("src"),g=0,f=0;if("object"===typeof a)if(a.monthly&&
(g=a.monthly[Object.keys(a.monthly)[0]].id),a.onetime&&(f=a.onetime[Object.keys(a.onetime)[0]].id,f=999==f?a.onetime[Object.keys(a.onetime)[0]].data:f),a.period){var c=0!==f&&0!==g?",":"",l=b("#imagify-payment-iframe").data("imagify-api");iframe_plans=0!==f?"onetimeplan":"";iframe_plans+=c;iframe_plans+=0!==g?a.period+"plan":"";iframe_ids=0!==f?f:"";iframe_ids+=c;iframe_ids+=0!==g?g:"";d.attr("src",e+iframe_plans+"/"+iframe_ids+"/"+l)}else imagifyAdmin.labels.info("No period defined");else"string"===
typeof a&&""!==c&&(tofind="monthly"===a?"yearly":"monthly",c=c.replace(tofind,a),d.attr("src",c))},A=function(){return b(".imagify-cart").hasClass("imagify-month-selected")?"monthly":"yearly"};v.hide();q.hide();t.hide();u.on("click.imagify",function(){var a=b(this),d=a.data("imagify-choose");a.closest(".imagify-modal-views").hide().attr("aria-hidden","true");q.hide().attr("aria-hidden","true");v.fadeIn(300).attr("aria-hidden","false");var c=setInterval(function(){v.find('a[href="#imagify-pricing-tab-'+
("plan"==d?"monthly":"onetime")+'"]').trigger("click.imagify");clearInterval(c);c=null},60);return!1});z.on("click.imagify",".imagify-payment-btn-select-plan",function(){var a=b(this),d=a.closest(".imagify-offer-line"),c=a.data("offer"),e=a.attr("data-offer"),g="imagify-pricing-tab-monthly"===a.closest(".imagify-tab-content").attr("id")?!1:!0,f=g?w.find(".imagify-offer-onetime"):w.find(".imagify-offer-monthly"),a=g?null:a.closest(".imagify-pricing-table").hasClass("imagify-month-selected")?"monthly":
"yearly",c=g?n(c[Object.keys(c)[0]].price):n(c[Object.keys(c)[0]].prices,a),l=d.find(".imagify-approx-nb").text(),p=d.find(".imagify-offer-size").text(),h=g?"":'<span class="imagify-price-by">'+d.find(".imagify-price-by").text()+"</span>";v.hide().attr("aria-hidden","true");w.fadeIn(300).attr("aria-hidden","false");f.find(".imagify-number-block").html(c+h);f.find(".imagify-approx-nb").text(l);f.find(".imagify-offer-size").text(p);f.attr("data-offer",e);g||(f.find(".imagify-price-add-data").text(d.find(".imagify-price-add-data").text()),
"monthly"===a?f.find("#imagify-subscription-monthly").trigger("click.imagify"):f.find("#imagify-subscription-yearly").trigger("click.imagify"),f.find(".imagify-inline-options").find("input:radio:checked").trigger("change.imagify"));return!1});b("#imagify-modal-checkout-btn").on("click.imagify",function(){var a=b(".imagify-offer-monthly"),d=b(".imagify-offer-onetime"),c={},e=a.hasClass("imagify-year-selected")?"year":"month";a.hasClass("imagify-offer-selected")?(c.monthly=JSON.parse(a.attr("data-offer")),
b(".imagify-cart-list-my-choice").show(),prices=c.monthly[Object.keys(c.monthly)[0]].prices,save_price=Math.round(1200*(prices.monthly-prices.yearly))/100,b(".imagify-nb-save-per-year").text("$"+save_price)):b(".imagify-cart-list-my-choice").hide();d.hasClass("imagify-offer-selected")&&(c.onetime=JSON.parse(d.attr("data-offer")));w.hide().attr("aria-hidden","true");q.fadeIn(300).attr("aria-hidden","false");b(".imagify-cart-emptied-item").hide().attr("aria-hidden","true");b("#imagify-pricing-step-2").addClass("active");
q.find(".imagify-cart-item").hide().attr("data-offer","");b.each(c,function(a,c){var d=q.find(".imagify-cart-item-"+a),h=c[Object.keys(c)[0]],m=b(".imagify-cart");d.show();d.attr("data-offer",JSON.stringify(c));d.find(".imagify-the-product-name").text(h.name);d.find(".imagify-cart-offer-data").text(h.dataf);"onetime"===a?d.find(".imagify-number-block").html(n(h.price)):d.find(".imagify-number-block").find(".imagify-switch-my").html(n(h.prices,e+"ly"));m.removeClass("imagify-month-selected imagify-year-selected").addClass("imagify-"+
e+"-selected");"month"===e?m.find("#imagify-checkout-monthly").trigger("click.imagify"):m.find("#imagify-checkout-yearly").trigger("click.imagify");m.find(".imagify-inline-options").find("input:radio:checked").trigger("change.imagify")});c.period=A();h(c);return!1});b(".imagify-remove-from-cart").on("click.imagify",function(){var a=b(this).closest(".imagify-cart-item"),d=a.hasClass("imagify-cart-item-monthly"),c=d?b(".imagify-cart-item-onetime"):b(".imagify-cart-item-monthly"),e=c.hasClass("imagify-temporary-removed"),
g=a.attr("data-offer"),c=e?null:c.data("offer");a.hide().attr("aria-hidden","true").attr("data-offer","").addClass("imagify-temporary-removed");a.next(".imagify-cart-emptied-item").fadeIn(300).attr("aria-hidden","false").attr("data-offer",g).find(".imagify-removed-name").html(a.find(".imagify-cart-product-name").html());"function"===typeof h?null!==c?(a={},a[d?"onetime":"monthly"]=c,a.period=A(),h(a)):imagifyAdmin.labels.info("No offers selected"):imagifyAdmin.labels.info("imagify_iframe_set_src seems to be not declared");
return!1});b(".imagify-cancel-removing").on("click.imagify",function(){var a=b(this).closest(".imagify-cart-emptied-item"),d=a.prev(".imagify-cart-item").hasClass("imagify-cart-item-monthly"),c=d?b(".imagify-cart-item-onetime"):b(".imagify-cart-item-monthly"),e=c.hasClass("imagify-temporary-removed"),g=a.attr("data-offer"),c=e?null:c.data("offer");a.hide().attr("aria-hidden","true").attr("data-offer","").prev(".imagify-cart-item").fadeIn(300).attr("aria-hidden","true").attr("data-offer",g).removeClass("imagify-temporary-removed");
a={};a.monthly=d?JSON.parse(g):c;a.onetime=d?c:JSON.parse(g);a.period=A();"function"===typeof h?h(a):imagifyAdmin.labels.info("imagify_iframe_set_src seems to be not declared\u2026");return!1});b(".imagify-cart-list-my-choice").find('input[type="radio"]').on("change.imagify",function(){h(b(this).val())});b(".imagify-back-to-plans").on("click.imagify",function(){b(this).closest(".imagify-cart-item").hasClass("imagify-cart-item-onetime")?b(".imagify-offer-onetime").find(".imagify-choose-another-plan").trigger("click.imagify"):
b(".imagify-offer-monthly").find(".imagify-choose-another-plan").trigger("click.imagify");return!1})}if(b(".imagify-tabs").length)b(".imagify-tab").on("click.imagify",function(){var a=b(this);if(!a.hasClass("imagify-current")){var d=a.find("a").attr("href")||"#"+a.find("a").attr("aria-controls");a.closest(".imagify-tabs").next(".imagify-tabs-contents").find(".imagify-tab-content").hide().attr("aria-hidden","true");b(d).fadeIn(275).attr("aria-hidden","false");a.closest(".imagify-tabs").find(".imagify-tab").removeClass("imagify-current").attr("aria-selected",
"false");a.addClass("imagify-current").attr("aria-selected","true")}return!1})});